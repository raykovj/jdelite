define("modules/graph/graphPort",["modules/geometry/rectangle","modules/geometry/point","modules/graph/graphElement","modules/draw/draw","modules/graph/graphConstants","modules/graph/modelUtils","modules/settings/config","modules/html/iconLoader","modules/core/jsUtils"],function(e,t,n,o,r,l,d,c,g){function a(g){function s(){return d.getLinkStyle()===r.linkStyle().DOUBLE_ARROW?Math.floor(A.width/2):d.getLinkStyle()!==r.linkStyle().SINGLE_ARROW?0:u(r.nodeSide().FRONT)?(d.getFlowDirection(),r.flow().HORIZONTAL,Math.floor(A.width/2)):u(r.nodeSide().BACK)?d.getFlowDirection()===r.flow().HORIZONTAL?Math.floor(A.width):Math.floor(A.width/2):u(r.nodeSide().LEFT)?d.getFlowDirection()===r.flow().HORIZONTAL?Math.floor(A.width/2):0:u(r.nodeSide().RIGHT)?d.getFlowDirection()===r.flow().HORIZONTAL?Math.floor(A.width/2):Math.floor(A.width):void 0}function f(){return d.getLinkStyle()===r.linkStyle().DOUBLE_ARROW?Math.floor(A.height/2):d.getLinkStyle()!==r.linkStyle().SINGLE_ARROW?0:u(r.nodeSide().FRONT)?(d.getFlowDirection(),r.flow().HORIZONTAL,Math.floor(A.height/2)):u(r.nodeSide().BACK)?d.getFlowDirection()===r.flow().HORIZONTAL?Math.floor(A.height/2):Math.floor(A.height):u(r.nodeSide().LEFT)?d.getFlowDirection()===r.flow().HORIZONTAL?Math.floor(A.height):Math.floor(A.height/2):u(r.nodeSide().RIGHT)?d.getFlowDirection()===r.flow().HORIZONTAL?0:Math.floor(A.height/2):void 0}function T(){if(d.hasShowTooltip())return A.getPath();if(A.getDirection()===r.portDirection().OUT){if(A.getType()===r.portType().LINK_CNX)return"Drag to different output";if(A.getType()===r.portType().LINK_REF)return"Drag to different reference output"}else if(A.getDirection()===r.portDirection().IN){if(A.getType()===r.portType().LINK_CNX)return"Drag to different input";if(A.getType()===r.portType().LINK_REF)return"Drag to different reference input"}}function u(e){return(A.getSide()&e)>0}function O(e){return e===r.linkStyle().DOUBLE_ARROW?c.eastIcon:e===r.linkStyle().SINGLE_ARROW?c.eastArrowIcon:void 0}function S(e){return e===r.linkStyle().DOUBLE_ARROW?c.westIcon:e===r.linkStyle().SINGLE_ARROW?c.westArrowIcon:void 0}function R(e){return e===r.linkStyle().DOUBLE_ARROW?c.northIcon:e===r.linkStyle().SINGLE_ARROW?c.northArrowIcon:void 0}function p(e){return e===r.linkStyle().DOUBLE_ARROW?c.southIcon:e===r.linkStyle().SINGLE_ARROW?c.southArrowIcon:void 0}function I(e){return e===r.linkStyle().DOUBLE_ARROW?c.eastIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.eastArrowIcon:void 0}function h(e){return e===r.linkStyle().DOUBLE_ARROW?c.westIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.westArrowIcon:void 0}function L(e){return e===r.linkStyle().DOUBLE_ARROW?c.northIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.northArrowIcon:void 0}function y(e){return e===r.linkStyle().DOUBLE_ARROW?c.southIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.southArrowIcon:void 0}function w(e){return e===r.linkStyle().DOUBLE_ARROW?c.eastRefIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.eastArrowIcon:void 0}function D(e){return e===r.linkStyle().DOUBLE_ARROW?c.westRefIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.westArrowIcon:void 0}function N(e){return e===r.linkStyle().DOUBLE_ARROW?c.northRefIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.northArrowIcon:void 0}function E(e){return e===r.linkStyle().DOUBLE_ARROW?c.southRefIcon:e===r.linkStyle().SINGLE_ARROW&&A.isHighlighted()?c.southArrowIcon:void 0}n.call(this,new e(0,0,0,0));var A=this,F=r.colors().EDGE,_=r.colors().ACCEPT_PORT,H="";A.setId(r.elementType().PORT),A.connector=g,A.getConnector=function(){return A.connector},A.setName(g.getName()),A.mode=r.portMode().NONE,A.node=g.getNode(),A.getNode=function(){return A.node},A.getDirection=function(){return A.connector.getDirection()},A.getSide=function(){return A.connector.getSide()},A.setSide=function(e){return A.connector.setSide(e)};var k=r.portType().LINK_CNX;A.getType=function(){return k},A.setType=function(e){k=e};var C;A.getDummyParentName=function(){return C},A.setDummyParentName=function(e){C=e},A.getPortBounds=function(){return A.getDNDShape()},A.getDNDShape=function(){var t=d.getLinkStyle()===r.linkStyle().DOUBLE_ARROW?1:A.getDirection()===r.portDirection().OUT?4:1;return new e(A.connector.globalX()-s()-t,A.connector.globalY()-f()-t,A.width+2*t,A.height+2*t)},A.shiftCnxPortUp=function(e){A.getConnector().setOrder(A.getConnector().getOrder()+1),A.getSide()===r.nodeSide().FRONT?d.getFlowDirection()===r.flow().HORIZONTAL?A.getConnector().translate(0,e):A.getConnector().translate(e,0):A.getSide()===r.nodeSide().BACK?d.getFlowDirection()===r.flow().HORIZONTAL?A.getConnector().translate(0,e):A.getConnector().translate(e,0):A.getSide()===r.nodeSide().LEFT?d.getFlowDirection()===r.flow().HORIZONTAL?A.getConnector().translate(e,0):A.getConnector().translate(0,e):A.getSide()===r.nodeSide().RIGHT&&(d.getFlowDirection()===r.flow().HORIZONTAL?A.getConnector().translate(e,0):A.getConnector().translate(0,e))},A.isPortVisible=function(){var e=A.edgeList.length>0&&(A.dndMode===r.dndMode().ORIGIN||A.edgeList[0].isLinkVisible());return A.isVisible()&&e&&A.getType()!==r.portType().DUMMY},A.containsPoint=function(e){var t=A.isPortVisible()&&A.getPortBounds().containsXY(e.x,e.y);return H=t?T():void 0,t},A.getTooltip=function(){return H},A.init=function(){A.setRectSize(r.portDefSize().WIDTH,r.portDefSize().HEIGHT),A.setRectLocation(A.connector.globalX()-Math.floor(A.width/2),A.connector.globalY()-Math.floor(A.height/2))},A.getIcon=function(){var e,t=A.getDirection(),n=d.getLinkStyle();return k===r.portType().LINK_CNX?d.getFlowDirection()===r.flow().HORIZONTAL?u(r.nodeSide().FRONT)?e=t===r.portDirection().OUT?I(n):S(n):u(r.nodeSide().BACK)?e=t===r.portDirection().OUT?h(n):O(n):u(r.nodeSide().LEFT)?e=t===r.portDirection().OUT?L(n):p(n):u(r.nodeSide().RIGHT)&&(e=t===r.portDirection().OUT?y(n):R(n)):u(r.nodeSide().FRONT)?e=t===r.portDirection().OUT?y(n):R(n):u(r.nodeSide().BACK)?e=t===r.portDirection().OUT?L(n):p(n):u(r.nodeSide().LEFT)?e=t===r.portDirection().OUT?I(n):S(n):u(r.nodeSide().RIGHT)&&(e=t===r.portDirection().OUT?h(n):O(n)):k===r.portType().LINK_REF&&(d.getFlowDirection()===r.flow().HORIZONTAL?u(r.nodeSide().FRONT)?e=t===r.portDirection().OUT?w(n):c.westRefIcon:u(r.nodeSide().BACK)?e=t===r.portDirection().OUT?D(n):c.eastRefIcon:u(r.nodeSide().LEFT)?e=t===r.portDirection().OUT?N(n):c.southRefIcon:u(r.nodeSide().RIGHT)&&(e=t===r.portDirection().OUT?E(n):c.northRefIcon):u(r.nodeSide().FRONT)?e=t===r.portDirection().OUT?E(n):c.northRefIcon:u(r.nodeSide().BACK)?e=t===r.portDirection().OUT?N(n):c.southRefIcon:u(r.nodeSide().LEFT)?e=t===r.portDirection().OUT?w(n):c.westRefIcon:u(r.nodeSide().RIGHT)&&(e=t===r.portDirection().OUT?D(n):c.eastRefIcon)),e||(e=c.emptyPort),A.setRectSize(e.width,e.height),e},A.getHighlightedShapeShape=function(){return new e(A.connector.globalX()-s()-1,A.connector.globalY()-f()-1,A.width+2,A.height+2)},A.drawPort=function(e){if(A.isPortVisible()){var t=A.getIcon();(A.isHighlighted()||A.dndMode===r.dndMode().DESTINATION)&&U(e);var n=A.connector.globalX()-s(),o=A.connector.globalY()-f();e.drawImage(t,n,o)}};var U=function(e){e.strokeStyle=F,e.fillStyle=A.dragMode===r.dragMode().ACCEPT_PORT?_:F;var t=A.getHighlightedShapeShape(),n=t.x,i=t.y,l=t.width,d=t.height;o.roundRect(e,n,i,l,d,4)};A.setFixed=function(e){A.connector.setFixed(e)},A.isFixed=function(){return A.connector.isFixed()},A.setOrder=function(e){return A.connector.setOrder(e)},A.getOrder=function(){return A.connector.getOrder()},A.nodeOffset=0,A.setOffset=function(e){A.nodeOffset=e},A.getOffset=function(){return A.nodeOffset},A.setOffsetStep=function(e){A.node.getFlowType()!==r.flowType().DECISION&&A.connector.setOffsetStep(e)},A.getOffsetStep=function(){return A.connector.getOffsetStep()},A.edgeList=[],A.addEdgeOnInit=function(e){A.edgeList=[],A.edgeList.push(e)},A.addEdge=function(e){A.getDirection()!==r.portDirection().NONE&&0===A.edgeList.length&&A.edgeList.push(e)},A.removeEdge=function(e){var t=A.edgeList.indexOf(e);t<=0&&t<A.edgeList.length&&A.edgeList.splice(t,1)},A.getEdgesList=function(){return A.edgeList},A.hasEdges=function(){return A.edgeList.length>0},A.getConnectionPoint=function(){return l.getEdgeConnectionPoint(A)},A.updateEdgesSourceSide=function(e){for(i=0;i<A.edgeList.length;i++)A.edgeList[i].setSourceSide(e)},A.getAttachmentPoint=function(){var e=l.getEdgeConnectionPoint(A),n=new t(e.x,e.y),o=A.getNode(),i=d.getLinkStyle()===r.linkStyle().DOUBLE_ARROW?3:-2,c=d.getLinkStyle()===r.linkStyle().DOUBLE_ARROW?3:6;return A.getDirection()===r.portDirection().IN?d.getFlowDirection()===r.flow().HORIZONTAL?o.getFlowType()===r.flowType().LEFT_TOP?n.translate(0,-i):o.getFlowType()===r.flowType().RIGHT_BOTTOM?n.translate(0,i):A.getType()===r.portType().LINK_REF?u(r.nodeSide().LEFT)?n.translate(0,i):u(r.nodeSide().RIGHT)&&n.translate(0,-i):o.getFlowType()===r.flowType().DECISION?o.getInput()===r.decisionInputs().BACK?n.translate(i,0):o.getInput()===r.decisionInputs().LEFT?n.translate(0,i):o.getInput()===r.decisionInputs().RIGHT&&n.translate(0,-i):n.translate(i,0):d.getFlowDirection()===r.flow().VERTICAL&&(o.getFlowType()===r.flowType().LEFT_TOP?n.translate(-i,0):o.getFlowType()===r.flowType().RIGHT_BOTTOM?n.translate(i,0):A.getType()===r.portType().LINK_REF?u(r.nodeSide().LEFT)?n.translate(-i,0):u(r.nodeSide().RIGHT)&&n.translate(i,0):o.getFlowType()===r.flowType().DECISION?o.getInput()===r.decisionInputs().BACK?n.translate(0,i):o.getInput()===r.decisionInputs().LEFT?n.translate(-i,0):o.getInput()===r.decisionInputs().RIGHT&&n.translate(i,0):n.translate(0,i)):A.getDirection()===r.portDirection().OUT&&d.getLinkStyle()===r.linkStyle().SINGLE_ARROW&&(d.getFlowDirection()===r.flow().HORIZONTAL?A.getType()===r.portType().LINK_REF?u(r.nodeSide().LEFT)?n.translate(0,c):u(r.nodeSide().RIGHT)&&n.translate(0,-c):o.getFlowType()===r.flowType().LEFT_TOP?n.translate(0,-c):o.getFlowType()===r.flowType().RIGHT_BOTTOM?n.translate(0,c):o.getFlowType()===r.flowType().DECISION?u(r.nodeSide().FRONT)?n.translate(-c,0):u(r.nodeSide().BACK)?n.translate(c,0):u(r.nodeSide().LEFT)?n.translate(0,c):u(r.nodeSide().RIGHT)&&n.translate(0,-c):n.translate(-c,0):d.getFlowDirection()===r.flow().VERTICAL&&(A.getType()===r.portType().LINK_REF?u(r.nodeSide().LEFT)?n.translate(-c,0):u(r.nodeSide().RIGHT)&&n.translate(c,0):o.getFlowType()===r.flowType().LEFT_TOP?n.translate(-c,0):o.getFlowType()===r.flowType().RIGHT_BOTTOM?n.translate(c,0):o.getFlowType()===r.flowType().DECISION?u(r.nodeSide().FRONT)?n.translate(0,-c):u(r.nodeSide().BACK)?n.translate(0,c):u(r.nodeSide().LEFT)?n.translate(-c,0):u(r.nodeSide().RIGHT)&&n.translate(c,0):n.translate(0,-c))),n},A.dndMode=r.dndMode().NONE,A.setDNDMode=function(e){A.dndMode=e},A.getDNDMode=function(){return A.dndMode},A.dragMode=r.dragMode().NONE,A.setDragMode=function(e){A.dragMode=e},A.equals=function(e){return e instanceof a&&A.getPath()===e.getPath()},A.getPath=function(){return"["+A.getNode().getName()+"/"+A.getName()+"]"},A.print=function(){return A.constructor.name+": "+A.getPath()+", type="+A.getType()+", side="+A.getSide()},A.printPort=function(){return A.getName()+", x="+(A.connector.globalX()-s())+", y="+(A.connector.globalY()-f())+", type="+A.getType()+", order="+A.getOrder()+", side="+A.getSide()},A.init()}return g.inherit(a,n),a});