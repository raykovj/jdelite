define(["jquery","jqueryui","knockout","modules/settings/config","modules/html/iconLoader","modules/graph/graphConstants"],function(e,t,o,n,a,s){function i(){function t(){r=n.getLayoutMode(),i=n.getStartEndLevels(),l=n.getSideSwimLanes(),g=n.getFlowDirection(),h=n.getCanvasLevels(),p=n.getCanvasLanes(),u=n.hasAutoGenNodeNames(),k=n.getLinkStyle(),L=n.hasShowRefHandles(),n.getFlowDirection()===s.flow().VERTICAL?e("#btnVertical").prop("checked",!0):n.getFlowDirection()===s.flow().HORIZONTAL&&e("#btnHorizontal").prop("checked",!0),n.getLayoutMode()===s.layoutMode().AUTO?A.prop("checked",!0):n.getLayoutMode()===s.layoutMode().MANUAL&&e("#btnManual").prop("checked",!0),f.prop("disabled",A.prop("checked")),A.prop("checked")&&e("#labelAddCorridors").addClass("disabled"),e("#spinnerLevels").spinner("value",h),e("#spinnerLanes").spinner("value",p),e("#chkStartEnd").prop("checked",n.hasStartEndLevels()),e("#chkLeftRight").prop("checked",n.hasSideSwimLanes()),e("#chkGrid").prop("checked",n.hasShowGrid()),e("#chkAutoGen").prop("checked",n.hasAutoGenNodeNames()),e("#chkShowRefs").prop("checked",n.hasShowRefHandles()),f.prop("checked",n.hasEnableAddCorridors()),n.getLinkStyle()===s.linkStyle().SINGLE_ARROW?e("#styleSingleId").prop("checked",!0):n.getLinkStyle()===s.linkStyle().DOUBLE_ARROW&&e("#styleDoubleId").prop("checked",!0)}function o(){e("#btnVertical").prop("checked")&&g!==s.flow().VERTICAL?a.getCaller().changeFlowDirection(s.flow().VERTICAL):e("#btnHorizontal").prop("checked")&&g!==s.flow().HORIZONTAL&&a.getCaller().changeFlowDirection(s.flow().HORIZONTAL),A.prop("checked")?n.setLayoutMode(s.layoutMode().AUTO):e("#btnManual").prop("checked")&&n.setLayoutMode(s.layoutMode().MANUAL),n.setCanvasLevels(e("#spinnerLevels").spinner("value")),n.setCanvasLanes(e("#spinnerLanes").spinner("value")),d=e("#chkStartEnd").prop("checked")?s.bValue().TRUE:s.bValue().FALSE,c=e("#chkLeftRight").prop("checked")?s.bValue().TRUE:s.bValue().FALSE,n.setShowGrid(e("#chkGrid").prop("checked")),n.setAutoGenNodeNames(e("#chkAutoGen").prop("checked")),n.setEnableAddCorridors(e("#chkAddCorridors").prop("checked")),n.setShowRefHandles(e("#chkShowRefs").prop("checked")),e("#styleSingleId").prop("checked")?n.setLinkStyle(s.linkStyle().SINGLE_ARROW):e("#styleDoubleId").prop("checked")&&n.setLinkStyle(s.linkStyle().DOUBLE_ARROW);var t,o,S,f;i!==d&&(t=!0,o=d===s.bValue().TRUE?s.change().UP:s.change().DOWN),l!==c&&(S=!0,f=c===s.bValue().TRUE?s.change().UP:s.change().DOWN),(t||S)&&a.getFlowController().changeCanvasSettings(t,o,S,f),r===n.getLayoutMode()&&i===n.getStartEndLevels()&&l===n.getSideSwimLanes()||a.setSettingsChanged(!0),a.hasDiagramOpen()&&k!==n.getLinkStyle()&&a.setSettingsChanged(!0),h===n.getCanvasLevels()&&p===n.getCanvasLanes()||a.setSettingsChanged(!0),!a.hasDiagramOpen()||u===n.hasAutoGenNodeNames()&&L===n.hasShowRefHandles()||a.setSettingsChanged(!0),a.getCaller().updateWindow(),a.refreshDiagram()}var a,i,l,d,c,r,h,p,g,u,k,L,S=this,f=e("#chkAddCorridors"),A=e("#btnAuto");S.initDialog=function(n){a=n;var s=e("#settingsDialogId");s.dialog({autoOpen:!1,closeOnEscape:!1,width:410,height:400,show:{effect:"slideDown",duration:250},hide:{effect:"slideUp",duration:250},modal:!0,resizable:!1,title:"Settings",position:{my:"left top",at:"left bottom+4",of:e("#configId")},open:function(e,o){t()},buttons:[{text:"OK",click:function(){e(this).dialog("close"),o()}},{text:"Cancel",autofocus:!0,click:function(){e(this).dialog("close")}}]}),e(".ui-dialog-titlebar-close").hide(),e(document).on("click",".ui-widget-overlay",function(){s.dialog("close")})}}return new i});