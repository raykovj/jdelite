define("modules/diagram/decisionNode",["modules/graph/graphNode","modules/diagram/flowNode","modules/draw/draw","modules/draw/drawUtils","modules/geometry/rectangle","modules/graph/graphConstants","modules/diagram/diagramUtils","modules/settings/config","modules/graph/modelUtils","modules/core/jsUtils"],function(e,o,n,t,i,d,T,s,E,r){function c(E,r,c){function R(){var o=f.getMarkupOutPortForName(e.MARK_D_TRUE),n=f.getMarkupOutPortForName(e.MARK_D_FALSE),t=s.getFlowDirection();Y===d.decisionInputs().BACK?A(o,n,t):Y===d.decisionInputs().LEFT?S(o,n,t):Y===d.decisionInputs().RIGHT&&C(o,n,t)}function A(e,o,n){w===d.decisionEnds().TRUE_FALSE_EMPTY?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().RIGHT:d.nodeSide().LEFT),o.setSide(d.nodeSide().FRONT)):w===d.decisionEnds().FALSE_TRUE_EMPTY?(e.setSide(d.nodeSide().FRONT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().RIGHT:d.nodeSide().LEFT)):w===d.decisionEnds().TRUE_EMPTY_FALSE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().RIGHT:d.nodeSide().LEFT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().LEFT:d.nodeSide().RIGHT)):w===d.decisionEnds().FALSE_EMPTY_TRUE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().LEFT:d.nodeSide().RIGHT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().RIGHT:d.nodeSide().LEFT)):w===d.decisionEnds().EMPTY_TRUE_FALSE?(e.setSide(d.nodeSide().FRONT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().LEFT:d.nodeSide().RIGHT)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(e.setSide(n===d.flow().VERTICAL?d.nodeSide().LEFT:d.nodeSide().RIGHT),o.setSide(d.nodeSide().FRONT))}function S(e,o,n){w===d.decisionEnds().TRUE_FALSE_EMPTY?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT),o.setSide(d.nodeSide().RIGHT)):w===d.decisionEnds().FALSE_TRUE_EMPTY?(e.setSide(d.nodeSide().RIGHT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT)):w===d.decisionEnds().TRUE_EMPTY_FALSE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK)):w===d.decisionEnds().FALSE_EMPTY_TRUE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK),o.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT)):w===d.decisionEnds().EMPTY_TRUE_FALSE?(e.setSide(d.nodeSide().RIGHT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(e.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK),o.setSide(d.nodeSide().RIGHT))}function C(e,o,n){w===d.decisionEnds().TRUE_FALSE_EMPTY?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK),o.setSide(d.nodeSide().LEFT)):w===d.decisionEnds().FALSE_TRUE_EMPTY?(e.setSide(d.nodeSide().LEFT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK)):w===d.decisionEnds().TRUE_EMPTY_FALSE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK),o.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT)):w===d.decisionEnds().FALSE_EMPTY_TRUE?(e.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().FRONT:d.nodeSide().BACK)):w===d.decisionEnds().EMPTY_TRUE_FALSE?(e.setSide(d.nodeSide().LEFT),o.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(e.setSide(n===d.flow().VERTICAL?d.nodeSide().BACK:d.nodeSide().FRONT),o.setSide(d.nodeSide().LEFT))}function I(){for(var e,o=f.getOutputPorts(),n=0;n<o.length;n++)o[n].getName().indexOf(P)>1?(e=T.getDecisionTruePortSide(f),o[n].setSide(e),o[n].updateEdgesSourceSide(e)):o[n].getName().indexOf(p)>1&&(e=T.getDecisionFalsePortSide(f),o[n].setSide(e),o[n].updateEdgesSourceSide(e))}function L(e,o,n,t,i){w===d.decisionEnds().TRUE_FALSE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(e,o/2)):w===d.decisionEnds().FALSE_TRUE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(0,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,0)):w===d.decisionEnds().TRUE_EMPTY_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(e/2,o)):w===d.decisionEnds().FALSE_EMPTY_TRUE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(0,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e/2,0)):w===d.decisionEnds().EMPTY_TRUE_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,o)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(i===d.flow().VERTICAL?(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e,o/2)))}function u(e,o,n,t,i){w===d.decisionEnds().TRUE_FALSE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(0,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,o)):w===d.decisionEnds().FALSE_TRUE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e/2,0)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e,o/2)):w===d.decisionEnds().TRUE_EMPTY_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(0,o/2)):w===d.decisionEnds().FALSE_EMPTY_TRUE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e/2,0)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e,o/2)):w===d.decisionEnds().EMPTY_TRUE_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(0,o/2)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(0,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e/2,o)))}function g(e,o,n,t,i){w===d.decisionEnds().TRUE_FALSE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e/2,0)):w===d.decisionEnds().FALSE_TRUE_EMPTY?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(0,o/2)):w===d.decisionEnds().TRUE_EMPTY_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,o),t.getConnector().moveToXY(e/2,0)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(0,o/2),t.getConnector().moveToXY(e,o/2)):w===d.decisionEnds().FALSE_EMPTY_TRUE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(e/2,o)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(0,o/2)):w===d.decisionEnds().EMPTY_TRUE_FALSE?i===d.flow().VERTICAL?(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,0)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(0,o/2)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(i===d.flow().VERTICAL?(n.getConnector().moveToXY(e/2,0),t.getConnector().moveToXY(e,o/2)):i===d.flow().HORIZONTAL&&(n.getConnector().moveToXY(e,o/2),t.getConnector().moveToXY(e/2,0)))}function l(e){var o=f.getContentDecisionSize();if(o){var n,i,T,E,r=d.contentDecisionViewExt().WIDTH,c=f.getFontHeight(e),R=f.getTextLeading();T=o.width+5,E=o.height+5;var A=t.getDecisionTextRectangle(f,e,c,R,r);T=A.width,E=A.height,s.hasShowTitleOnContent()&&(E+=c+R),n=f.x+Math.floor((f.width-T)/2),i=f.y+Math.floor((f.height-E)/2),e.fillStyle=d.colors().CONTENT_TEXT;var S=t.getContentLines();if(s.hasShowTitleOnContent()){var C=t.getTextTruncated(f.getName(),e,d.contentDecisionSize().WIDTH/2);S.splice(0,0,C)}for(var I=0;I<S.length;I++){var L=S[I],u=Math.floor(e.measureText(L).width),g=n+Math.floor((T-u)/2),l=i+c-2+(c+R)*I;e.fillText(L,g,l),0==I&&f.nameRect.setRectBounds(g,l-c,u,c+R)}return!0}return!1}function _(o){var n,t=f.getInputPorts();for(n=0;n<t.length;n++)t[n].drawPort(o);var i=f.getOutputPorts();for(n=0;n<i.length;n++)i[n].drawPort(o);f.markupInPort&&f.markupInPort.drawPort(o),f.markupOutPort&&f.markupOutPort.drawPort(o);var d=f.getMarkupOutPortForName(e.MARK_D_TRUE),T=f.getMarkupOutPortForName(e.MARK_D_FALSE);d&&d.drawPort(o),T&&T.drawPort(o)}function F(e){var o=f.getCurrentWidth(),n=f.getCurrentHeight(),t=f.x,i=f.y+6,T=e.measureText(P).width,E=f.x,r=f.y+6,c=e.measureText(p).width,R=s.getFlowDirection();w===d.decisionEnds().TRUE_FALSE_EMPTY?R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t-=T-4,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().LEFT?(t+=o/2+4,i-=6,E-=c-4,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i+=n,E+=o,r+=n/2+6):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o/2+4,i-=6,E+=o,r+=n/2+6):Y===d.decisionInputs().LEFT?(t+=o,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().RIGHT&&(t-=T-4,i+=n/2+6,E+=o/2+4,r-=6)):w===d.decisionEnds().FALSE_TRUE_EMPTY?R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t+=o/2+4,i+=n,E-=c-4,r+=n/2+6):Y===d.decisionInputs().LEFT?(t-=T-4,i+=n/2+6,E+=o/2+4,r-=6):Y===d.decisionInputs().RIGHT&&(t+=o,i+=n/2+6,E+=o/2+4,r+=n):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o,i+=n/2+6,E+=o/2+4,r-=6):Y===d.decisionInputs().LEFT?(t+=o/2+4,i+=n,E+=o,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i-=6,E-=c-4,r+=n/2+6)):w===d.decisionEnds().TRUE_EMPTY_FALSE?R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t-=T-4,i+=n/2+6,E+=o,r+=n/2+6):Y===d.decisionInputs().LEFT?(t+=o/2+4,i-=6,E+=o/2+4,r+=n):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i+=n,E+=o/2+4,r-=6):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o/2+4,i-=6,E+=o/2+4,r+=n):Y===d.decisionInputs().LEFT?(t+=o,i+=n/2+6,E-=c-4,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t-=T-4,i+=n/2+6,E+=o,r+=n/2+6)):w===d.decisionEnds().FALSE_EMPTY_TRUE?R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t+=o,i+=n/2+6,E-=c-4,r+=n/2+6):Y===d.decisionInputs().LEFT?(t+=o/2+4,i+=n,E+=o/2+4,r-=6):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i-=6,E+=o/2+4,r+=n):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o/2+4,i+=n,E+=o/2+4,r-=6):Y===d.decisionInputs().LEFT?(t-=T-4,i+=n/2+6,E+=o,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t+=o,i+=n/2+6,E-=c-4,r+=n/2+6)):w===d.decisionEnds().EMPTY_TRUE_FALSE?R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t+=o/2+4,i+=n,E+=o,r+=n/2+6):Y===d.decisionInputs().LEFT?(t-=T-4,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().RIGHT&&(t+=o,i+=n/2+6,E+=o/2+4,r-=6):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().LEFT?(t+=o/2+4,i+=n,E-=c-4,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i-=6,E+=o,r+=n/2+6)):w===d.decisionEnds().EMPTY_FALSE_TRUE&&(R===d.flow().VERTICAL?Y===d.decisionInputs().BACK?(t+=o,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().LEFT?(t+=o/2+4,i+=n,E-=c-4,r+=n/2+6):Y===d.decisionInputs().RIGHT&&(t+=o/2+4,i-=6,E+=o,r+=n/2+6):R===d.flow().HORIZONTAL&&(Y===d.decisionInputs().BACK?(t+=o/2+4,i+=n,E+=o,r+=n/2+6):Y===d.decisionInputs().LEFT?(t-=T-4,i+=n/2+6,E+=o/2+4,r+=n):Y===d.decisionInputs().RIGHT&&(t+=o,i+=n/2+6,E+=o/2+4,r-=6))),e.font="10px Arial",e.fillStyle="blue",m()&&e.fillText(P,t,i),a()&&e.fillText(p,E,r)}function m(){var o=f.getOutputPortForName(e.D_TRUE),n=f.getMarkupOutPortForName(e.MARK_D_TRUE),t=n&&n.getDNDMode()===d.dndMode().ORIGIN;return o||f.isHighlighted()||t}function a(){var o=f.getOutputPortForName(e.D_FALSE),n=f.getMarkupOutPortForName(e.MARK_D_FALSE),t=n&&n.getDNDMode()===d.dndMode().ORIGIN;return o||f.isHighlighted()||t}o.call(this,E,d.flowType().DECISION);var f=this,Y=d.decisionInputs().BACK;f.getInput=function(){return Y},f.setInput=function(e){Y=e};var w=c||d.decisionEnds().TRUE_EMPTY_FALSE;f.getEnds=function(){return w},f.setEnds=function(e){w=e,R()};var O=d.colors().NODE_D,v=d.colors().NODE_HLT_D,N=d.colors().NODE_SEL_D,P=d.portNames().TRUE,p=d.portNames().FALSE;d.drawState().NONE,new i(0,0,0,0);f.initNode=function(){},f.initDecisionNode=function(){f.setRectSize(d.decisionSize().WIDTH,d.decisionSize().HEIGHT),Y===d.decisionInputs().BACK?f.createMarkupDecisionInPort(d.nodeSide().BACK):Y===d.decisionInputs().LEFT?f.createMarkupDecisionInPort(d.nodeSide().LEFT):Y===d.decisionInputs().RIGHT&&f.createMarkupDecisionInPort(d.nodeSide().RIGHT),f.createMarkupDecisionOutPort(e.MARK_D_TRUE,d.nodeSide().FRONT),f.createMarkupDecisionOutPort(e.MARK_D_FALSE,d.nodeSide().FRONT),R()},f.modifyEnds=function(){w===d.decisionEnds().TRUE_FALSE_EMPTY?f.setEnds(d.decisionEnds().FALSE_TRUE_EMPTY):w===d.decisionEnds().FALSE_TRUE_EMPTY?f.setEnds(d.decisionEnds().TRUE_EMPTY_FALSE):w===d.decisionEnds().TRUE_EMPTY_FALSE?f.setEnds(d.decisionEnds().FALSE_EMPTY_TRUE):w===d.decisionEnds().FALSE_EMPTY_TRUE?f.setEnds(d.decisionEnds().EMPTY_TRUE_FALSE):w===d.decisionEnds().EMPTY_TRUE_FALSE?f.setEnds(d.decisionEnds().EMPTY_FALSE_TRUE):w===d.decisionEnds().EMPTY_FALSE_TRUE&&f.setEnds(d.decisionEnds().TRUE_FALSE_EMPTY),I()},f.getNodeObject=function(){var e={};return e.id=d.elementType().NODE,e.name=f.getName(),e.type=T.getFlowTypeName(f.getFlowType()),e.levelNum=f.getLevelNumber(),e.laneNum=f.getLaneNumber(),e.contentText=f.getContentText(),w&&w!==d.decisionEnds().UNDEF?e.decisionEnds=w:e.decisionEnds=d.decisionEnds().TRUE_EMPTY_FALSE,e},f.editParameters=function(e){},f.getNodeBounds=function(){var e=f.clone(),o=f.getCurrentWidth(),n=f.getCurrentHeight();return new i(e.x-10,e.y-10,o+20,n+20)},f.locateMarkupPorts=function(o){var n=f.getCurrentWidth(),t=f.getCurrentHeight(),i=f.getMarkupOutPortForName(e.MARK_D_TRUE),T=f.getMarkupOutPortForName(e.MARK_D_FALSE),E=s.getFlowDirection();Y===d.decisionInputs().BACK?(s.getFlowDirection()===d.flow().VERTICAL?f.markupInPort.getConnector().moveToXY(n/2,0):s.getFlowDirection()===d.flow().HORIZONTAL&&f.markupInPort.getConnector().moveToXY(0,t/2),L(n,t,i,T,E)):Y===d.decisionInputs().LEFT?(s.getFlowDirection()===d.flow().VERTICAL?f.markupInPort.getConnector().moveToXY(n,t/2):s.getFlowDirection()===d.flow().HORIZONTAL&&f.markupInPort.getConnector().moveToXY(n/2,0),u(n,t,i,T,E)):Y===d.decisionInputs().RIGHT&&(s.getFlowDirection()===d.flow().VERTICAL?f.markupInPort.getConnector().moveToXY(0,t/2):s.getFlowDirection()===d.flow().HORIZONTAL&&f.markupInPort.getConnector().moveToXY(n/2,t),g(n,t,i,T,E))},f.showMarkupPorts=function(o){f.markupInPort&&f.markupInPort.setVisible(o&&0===f.getInputConnections());var n=f.getOutputPortForName(e.D_TRUE),t=f.getMarkupOutPortForName(e.MARK_D_TRUE);t&&t.setVisible(o&&!n);var i=f.getOutputPortForName(e.D_FALSE),d=f.getMarkupOutPortForName(e.MARK_D_FALSE);d&&d.setVisible(o&&!i)},f.resetDNDFlags=function(){for(var e=f.getAllPorts(),o=0;o<e.length;o++)e[o].setDNDMode(d.dndMode().NONE)},f.drawGraphics=function(e){if(f.isVisible()){e.lineWidth=2,e.setLineDash([0,0]);var o=O;f.isHighlighted()&&(o=v),f.isSelected()&&(o=N),e.strokeStyle=o,e.font=d.font().TEXT,e.fillStyle=d.colors().NODE_BGNCOLOR;var t=f.getCurrentWidth(),i=f.getCurrentHeight();n.decisionPolygon(e,f.x,f.y,t,i,2),l(e)||f.drawName(e),_(e),F(e)}},f.initDecisionNode()}return r.inherit(c,o),c});